<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RWKV TTS è¯­éŸ³åˆæˆæœåŠ¡</title>
    <script type="module">
        import WaveSurfer from '/js/wavesurfer.esm.js';
        window.WaveSurfer = WaveSurfer;
    </script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }



        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea, #764ba2, #667eea, #9b59b6, #667eea);
            background-size: 400% 400%;
            animation: gradientShift 8s ease-in-out infinite;
            min-height: 100vh;
            padding: 20px;
        }

        @keyframes gradientShift {
            0% {
                background-position: 0% 50%;
            }
            25% {
                background-position: 100% 50%;
            }
            50% {
                background-position: 100% 100%;
            }
            75% {
                background-position: 0% 100%;
            }
            100% {
                background-position: 0% 50%;
            }
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            overflow: hidden;
            opacity: 0.85;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1200px;
            margin: 0 auto;
        }

        .header-left {
            text-align: left;
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            font-weight: 300;
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .lang-toggle {
            background: rgba(255, 255, 255, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: white;
            padding: 8px 16px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 6px;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .lang-toggle:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
        }

        .github-link {
            color: white;
            text-decoration: none;
            padding: 8px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .github-link:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
        }

        .tabs {
            display: flex;
            background: #f8f9fa;
            border-bottom: 1px solid #e9ecef;
        }

        .tab-button {
            flex: 1;
            padding: 15px 20px;
            background: none;
            border: none;
            cursor: pointer;
            font-size: 16px;
            font-weight: 500;
            color: #6c757d;
            transition: all 0.3s ease;
            border-bottom: 3px solid transparent;
        }

        .tab-button:hover {
            background: #e9ecef;
            color: #495057;
        }

        .tab-button.active {
            color: #667eea;
            border-bottom-color: #667eea;
            background: white;
        }

        .tab-content {
            display: none;
            padding: 30px;
        }

        .tab-content.active {
            display: block;
        }

        .form-group {
            margin-bottom: 25px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
        }

        .form-group textarea,
        .form-group input,
        .form-group select {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            font-size: 16px;
            transition: border-color 0.3s ease;
        }

        .form-group textarea:focus,
        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: #667eea;
        }

        .form-group textarea {
            resize: vertical;
            min-height: 120px;
        }

        .advanced-section {
            margin-top: 30px;
        }

        .advanced-toggle {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            padding: 12px 20px;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 500;
            color: #495057;
            transition: all 0.3s ease;
            display: block;
            width: 100%;
            text-align: left;
        }

        .advanced-toggle:hover {
            background: #e9ecef;
        }

        .advanced-content {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            transition: all 0.3s ease;
        }

        .advanced-content.hidden {
            display: none;
        }

        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }

        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 10px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
            margin-top: 20px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .loading {
            display: none;
            text-align: center;
            padding: 20px;
            color: #667eea;
            font-weight: 500;
        }

        .result {
            display: none;
            margin-top: 30px;
            padding: 20px;
            border-radius: 10px;
            font-weight: 500;
        }

        .result.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .result.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .audio-player {
            margin-top: 15px;
        }

        .audio-player audio {
            width: 100%;
            margin-bottom: 10px;
        }

        .status-section {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .status-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .status-item {
            background: white;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .status-item .label {
            font-size: 14px;
            color: #6c757d;
            margin-bottom: 5px;
        }

        .status-item .value {
            font-size: 18px;
            font-weight: 600;
            color: #333;
        }

        .voice-upload {
            border: 2px dashed #e9ecef;
            border-radius: 10px;
            padding: 30px;
            text-align: center;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .voice-upload:hover {
            border-color: #667eea;
            background: #f8f9ff;
        }

        .voice-upload.dragover {
            border-color: #667eea;
            background: #f0f4ff;
        }

        .upload-icon {
            font-size: 48px;
            color: #667eea;
            margin-bottom: 15px;
        }

        .upload-text {
            font-size: 16px;
            color: #6c757d;
            margin-bottom: 10px;
        }

        .upload-hint {
            font-size: 14px;
            color: #adb5bd;
        }

        .file-info {
            display: none;
            background: #e7f3ff;
            border: 1px solid #b3d9ff;
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
        }

        .file-info.show {
            display: block;
        }

        .voice-list {
            max-height: 200px;
            overflow-y: auto;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            background: white;
        }

        .voice-item {
            padding: 12px 15px;
            border-bottom: 1px solid #f1f3f4;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .voice-item:last-child {
            border-bottom: none;
        }

        .voice-item:hover {
            background: #f8f9fa;
        }

        .voice-name {
            font-weight: 500;
            color: #333;
        }

        .voice-actions {
            display: flex;
            gap: 10px;
        }

        .btn-small {
            padding: 5px 10px;
            font-size: 12px;
            border-radius: 5px;
            border: none;
            cursor: pointer;
            font-weight: 500;
        }

        .btn-danger {
            background: #dc3545;
            color: white;
        }

        .btn-danger:hover {
            background: #c82333;
        }

        @media (max-width: 768px) {
            .container {
                margin: 10px;
                border-radius: 15px;
            }

            .header {
                padding: 20px;
            }

            .header-content {
                flex-direction: column;
                gap: 15px;
                text-align: center;
            }

            .header-left {
                text-align: center;
            }

            .header h1 {
                font-size: 2em;
            }

            .header-right {
                justify-content: center;
            }

            .tab-content {
                padding: 20px;
            }

            .form-row {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="header-content">
                <div class="header-left">
                    <h1 data-i18n="title">ğŸµ RWKV TTS</h1>
                    <p data-i18n="subtitle">åŸºäº RWKV çš„é«˜è´¨é‡è¯­éŸ³åˆæˆæœåŠ¡</p>
                </div>
                <div class="header-right">
                    <button id="langToggle" class="lang-toggle" onclick="toggleLanguage()">
                        <span id="langIcon">ğŸŒ</span>
                        <span id="langText" data-i18n="lang-switch">ä¸­æ–‡</span>
                    </button>
                    <a href="https://github.com/" target="_blank" class="github-link" title="GitHub">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
                        </svg>
                    </a>
                </div>
            </div>
        </div>

        <div class="tabs">
            <button class="tab-button active" data-tab="tts" data-i18n="tab-tts">ğŸµ è¯­éŸ³ç”Ÿæˆ</button>
            <button class="tab-button" data-tab="clone" data-i18n="tab-clone">ğŸ­ å£°éŸ³å…‹éš†</button>
            <button class="tab-button" data-tab="api" data-i18n="tab-api">ğŸ“– APIè¯´æ˜</button>
        </div>

        <!-- è¯­éŸ³ç”Ÿæˆæ ‡ç­¾é¡µ -->
        <div id="tts" class="tab-content active">
            <form id="ttsForm">
                <div class="form-group">
                    <label for="text" data-i18n="input-text">è¾“å…¥æ–‡æœ¬</label>
                    <small style="color: #999; font-size: 12px; margin-left: 8px;" data-i18n="ipa-coming-soon">IPA å³å°†æ”¯æŒ</small>
                    <textarea id="text" name="text" placeholder="è¯·è¾“å…¥è¦è½¬æ¢ä¸ºè¯­éŸ³çš„æ–‡æœ¬..." data-i18n="text-placeholder" required></textarea>
                </div>

                <div class="form-group">
                    <label for="voiceSelect" data-i18n="voice-select">é€‰æ‹©éŸ³è‰²</label>
                    <select id="voiceSelect" name="voiceSelect">
                        <option value="none" data-i18n="default-voice">é»˜è®¤éŸ³è‰²</option>
                    </select>
                </div>

                <div class="advanced-section">
                    <div id="advancedContent" class="advanced-content show">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="seed" data-i18n="seed">éšæœºç§å­</label>
                                <input type="number" id="seed" name="seed" placeholder="ç•™ç©ºä¸ºéšæœº" data-i18n="seed-placeholder">
                            </div>
                            <div class="form-group">
                                <label for="temperature" data-i18n="temperature">Temperature</label>
                                <input type="number" id="temperature" name="temperature" value="1.0" min="0.1" max="2.0" step="0.1">
                            </div>
                            <div class="form-group">
                                <label for="topP" data-i18n="top-p">Top P</label>
                                <input type="number" id="topP" name="topP" value="0.9" min="0.1" max="1.0" step="0.1">
                            </div>
                            <div class="form-group">
                                <label for="speed" data-i18n="speed">è¯­é€Ÿ</label>
                                <select id="speed" name="speed">
                                    <option value="very_slow" data-i18n="very-slow">å¾ˆæ…¢</option>
                                    <option value="slow" data-i18n="slow">æ…¢</option>
                                    <option value="medium" data-i18n="medium" selected>ä¸­é€Ÿ</option>
                                    <option value="fast" data-i18n="fast">å¿«</option>
                                    <option value="very_fast" data-i18n="very-fast">å¾ˆå¿«</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="age" data-i18n="age">å¹´é¾„</label>
                                <select id="age" name="age">
                                    <option value="child" data-i18n="child">å„¿ç«¥</option>
                                    <option value="teenager" data-i18n="teenager">é’å°‘å¹´</option>
                                    <option value="youth-adult" data-i18n="youth-adult">é’å¹´-æˆå¹´</option>
                                    <option value="middle-aged" data-i18n="middle-aged">ä¸­å¹´</option>
                                    <option value="elderly" data-i18n="elderly">è€å¹´</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="gender" data-i18n="gender">æ€§åˆ«</label>
                                <select id="gender" name="gender">
                                    <option value="male" data-i18n="male">ç”·æ€§</option>
                            <option value="female" data-i18n="female">å¥³æ€§</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="emotion" data-i18n="emotion">æƒ…æ„Ÿ</label>
                                <select id="emotion" name="emotion">
                                    <option value="UNKNOWN" data-i18n="unknown">æœªçŸ¥</option>
                                    <option value="NEUTRAL" data-i18n="neutral">ä¸­æ€§</option>
                                    <option value="ANGRY" data-i18n="angry">æ„¤æ€’</option>
                                    <option value="HAPPY" data-i18n="happy">å¿«ä¹</option>
                                    <option value="SAD" data-i18n="sad">æ‚²ä¼¤</option>
                                    <option value="FEARFUL" data-i18n="fearful">ææƒ§</option>
                                    <option value="DISGUSTED" data-i18n="disgusted">åŒæ¶</option>
                                    <option value="SURPRISED" data-i18n="surprised">æƒŠè®¶</option>
                                    <option value="SARCASTIC" data-i18n="sarcastic">è®½åˆº</option>
                                    <option value="EXCITED" data-i18n="excited">å…´å¥‹</option>
                                    <option value="SLEEPY" data-i18n="sleepy">å›°å€¦</option>
                                    <option value="CONFUSED" data-i18n="confused">å›°æƒ‘</option>
                                    <option value="EMPHASIS" data-i18n="emphasis">å¼ºè°ƒ</option>
                                    <option value="LAUGHING" data-i18n="laughing">å¤§ç¬‘</option>
                                    <option value="SINGING" data-i18n="singing">æ­Œå”±</option>
                                    <option value="WORRIED" data-i18n="worried">æ‹…å¿§</option>
                                    <option value="WHISPER" data-i18n="whisper">è€³è¯­</option>
                                    <option value="ANXIOUS" data-i18n="anxious">ç„¦è™‘</option>
                                    <option value="NO-AGREEMENT" data-i18n="no-agreement">ä¸åŒæ„</option>
                                    <option value="APOLOGETIC" data-i18n="apologetic">é“æ­‰</option>
                                    <option value="CONCERNED" data-i18n="concerned">å…³åˆ‡</option>
                                    <option value="ENUNCIATED" data-i18n="enunciated">æ¸…æ™°å‘éŸ³</option>
                                    <option value="ASSERTIVE" data-i18n="assertive">åšå®š</option>
                                    <option value="ENCOURAGING" data-i18n="encouraging">é¼“åŠ±</option>
                                    <option value="CONTEMPT" data-i18n="contempt">è”‘è§†</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="pitch" data-i18n="pitch">éŸ³è°ƒ</label>
                                <select id="pitch" name="pitch">
                                    <option value="low_pitch" data-i18n="low-pitch">ä½éŸ³è°ƒ</option>
                                    <option value="medium_pitch" data-i18n="medium-pitch">ä¸­éŸ³è°ƒ</option>
                                    <option value="high_pitch" data-i18n="high-pitch">é«˜éŸ³è°ƒ</option>
                                    <option value="very_high_pitch" data-i18n="very-high-pitch">æé«˜éŸ³è°ƒ</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>

                <button type="submit" id="generateBtn" class="btn" data-i18n="generate-btn">ğŸµ ç”Ÿæˆè¯­éŸ³</button>
            </form>

            <div id="loading" class="loading">
                <div>ğŸ”„ æ­£åœ¨ç”Ÿæˆè¯­éŸ³ï¼Œè¯·ç¨å€™...</div>
            </div>

            <div id="result" class="result">
                <div id="resultMessage"></div>
                <div id="audioPlayer" class="audio-player"></div>
            </div>
        </div>

        <!-- å£°éŸ³å…‹éš†æ ‡ç­¾é¡µ -->
        <div id="clone" class="tab-content">
            <div class="form-group">
                <label data-i18n="upload-audio">ä¸Šä¼ éŸ³é¢‘æ–‡ä»¶</label>
                <div class="voice-upload" id="voiceUpload">
                    <div class="upload-icon">ğŸ¤</div>
                    <div class="upload-text" data-i18n="upload-drop-text">ç‚¹å‡»æˆ–æ‹–æ‹½éŸ³é¢‘æ–‡ä»¶åˆ°æ­¤å¤„</div>
                    <div class="upload-hint" data-i18n="upload-hint-text">æ”¯æŒ WAV, MP3 æ ¼å¼ï¼Œå»ºè®®æ—¶é•¿ 3-30 ç§’</div>
                    <input type="file" id="voiceFile" accept=".wav,.mp3" style="display: none;">
                </div>
                <div id="fileInfo" class="file-info">
                    <div id="fileName"></div>
                    <div id="fileSize"></div>
                </div>
                <!-- éŸ³é¢‘æ’­æ”¾å™¨ -->
                <div id="audioPreviewPlayer" class="audio-player" style="display: none; margin-top: 15px;">
                    <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #333;" data-i18n="audio-preview">ğŸµ éŸ³é¢‘é¢„è§ˆ</label>
                    <div id="waveform" style="width: 100%; height: 80px; border-radius: 8px; background: #f8f9fa; border: 1px solid #e9ecef;"></div>
                    <div class="audio-controls" style="margin-top: 10px; display: flex; align-items: center; gap: 10px;">
                        <button id="playPauseBtn" style="background: #667eea; color: white; border: none; padding: 8px 16px; border-radius: 6px; cursor: pointer; font-size: 14px;" data-i18n="play-btn">â–¶ï¸ æ’­æ”¾</button>
                        <span id="audioTime" style="font-size: 14px; color: #666;">00:00 / 00:00</span>
                    </div>
                </div>
            </div>

            <div class="form-group">
                <label for="voicePrompt" data-i18n="audio-content">éŸ³é¢‘å†…å®¹</label>
                <textarea id="voicePrompt" name="voicePrompt" placeholder="è¯·è¾“å…¥éŸ³é¢‘ä¸­è¯´è¯çš„æ–‡å­—å†…å®¹..." rows="3" data-i18n="audio-content-placeholder"></textarea>
            </div>

            <div class="form-group">
                <label for="voiceName" data-i18n="voice-name">éŸ³è‰²åç§°</label>
                <input type="text" id="voiceName" name="voiceName" placeholder="ä¸ºè¿™ä¸ªéŸ³è‰²èµ·ä¸€ä¸ªåå­—" data-i18n="voice-name-placeholder">
            </div>

            <button type="button" id="extractBtn" class="btn" onclick="extractVoiceFeature()" data-i18n="extract-voice">ğŸ­ æå–éŸ³è‰²ç‰¹å¾</button>

            <div id="cloneResult" class="result">
                <div id="cloneMessage"></div>
            </div>

            <div class="form-group" style="margin-top: 30px;">
                <label data-i18n="saved-voices">å·²ä¿å­˜çš„éŸ³è‰²</label>
                <div id="voiceList" class="voice-list">
                    <!-- éŸ³è‰²åˆ—è¡¨å°†åœ¨è¿™é‡ŒåŠ¨æ€åŠ è½½ -->
                </div>
            </div>
        </div>

        <!-- APIè¯´æ˜æ ‡ç­¾é¡µ -->
        <div id="api" class="tab-content">
            <div class="status-section">
                <h3 style="margin-bottom: 20px; color: #333;" data-i18n="api-title">ğŸ“– API æ¥å£è¯´æ˜</h3>
                
                <div style="background: white; padding: 20px; border-radius: 8px; margin-bottom: 20px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                    <h4 style="color: #667eea; margin-bottom: 15px;" data-i18n="tts-api-title">ğŸµ TTS è¯­éŸ³åˆæˆ API</h4>
                    <p><strong data-i18n="api-endpoint">æ¥å£åœ°å€ï¼š</strong><code>POST /api/tts</code></p>
                    <p><strong data-i18n="request-format">è¯·æ±‚æ ¼å¼ï¼š</strong>JSON</p>
                    
                    <h5 style="margin-top: 20px; margin-bottom: 10px;" data-i18n="request-params">è¯·æ±‚å‚æ•°ï¼š</h5>
                    <table style="width: 100%; border-collapse: collapse; margin-bottom: 15px;">
                        <tr style="background: #f8f9fa;">
                            <th style="border: 1px solid #dee2e6; padding: 8px; text-align: left;" data-i18n="param-name">å‚æ•°å</th>
                            <th style="border: 1px solid #dee2e6; padding: 8px; text-align: left;" data-i18n="param-type">ç±»å‹</th>
                            <th style="border: 1px solid #dee2e6; padding: 8px; text-align: left;" data-i18n="param-required">å¿…å¡«</th>
                            <th style="border: 1px solid #dee2e6; padding: 8px; text-align: left;" data-i18n="param-description">è¯´æ˜</th>
                        </tr>
                        <tr>
                            <td style="border: 1px solid #dee2e6; padding: 8px;">text</td>
                            <td style="border: 1px solid #dee2e6; padding: 8px;">string</td>
                            <td style="border: 1px solid #dee2e6; padding: 8px;" data-i18n="required-yes">æ˜¯</td>
                            <td style="border: 1px solid #dee2e6; padding: 8px;" data-i18n="text-content">è¦è½¬æ¢çš„æ–‡æœ¬å†…å®¹</td>
                        </tr>
                        <tr>
                            <td style="border: 1px solid #dee2e6; padding: 8px;">temperature</td>
                            <td style="border: 1px solid #dee2e6; padding: 8px;">float</td>
                            <td style="border: 1px solid #dee2e6; padding: 8px;" data-i18n="required-no">å¦</td>
                            <td style="border: 1px solid #dee2e6; padding: 8px;" data-i18n="sampling-temperature">é‡‡æ ·æ¸©åº¦ï¼Œé»˜è®¤1.0</td>
                        </tr>
                        <tr>
                            <td style="border: 1px solid #dee2e6; padding: 8px;">top_p</td>
                            <td style="border: 1px solid #dee2e6; padding: 8px;">float</td>
                            <td style="border: 1px solid #dee2e6; padding: 8px;" data-i18n="required-no">å¦</td>
                            <td style="border: 1px solid #dee2e6; padding: 8px;" data-i18n="top-p-sampling">Top-pé‡‡æ ·ï¼Œé»˜è®¤0.9</td>
                        </tr>
                        <tr>
                            <td style="border: 1px solid #dee2e6; padding: 8px;">speed</td>
                            <td style="border: 1px solid #dee2e6; padding: 8px;">float/string</td>
                            <td style="border: 1px solid #dee2e6; padding: 8px;" data-i18n="required-no">å¦</td>
                            <td style="border: 1px solid #dee2e6; padding: 8px;" data-i18n="speech-speed">è¯­é€Ÿï¼Œæ•°å€¼ç±»å‹é»˜è®¤1.0ï¼Œå­—ç¬¦ä¸²ç±»å‹å¯é€‰ï¼š"very_slow", "slow", "medium", "fast", "very_fast"ï¼Œé»˜è®¤"medium"</td>
                        </tr>
                        <tr>
                            <td style="border: 1px solid #dee2e6; padding: 8px;">seed</td>
                            <td style="border: 1px solid #dee2e6; padding: 8px;">int</td>
                            <td style="border: 1px solid #dee2e6; padding: 8px;" data-i18n="required-no">å¦</td>
                            <td style="border: 1px solid #dee2e6; padding: 8px;" data-i18n="random-seed">éšæœºç§å­ï¼Œå¯é€‰</td>
                        </tr>
                        <tr>
                            <td style="border: 1px solid #dee2e6; padding: 8px;">voice_id</td>
                            <td style="border: 1px solid #dee2e6; padding: 8px;">string</td>
                            <td style="border: 1px solid #dee2e6; padding: 8px;" data-i18n="required-no">å¦</td>
                            <td style="border: 1px solid #dee2e6; padding: 8px;" data-i18n="voice-id">éŸ³è‰²IDï¼ˆå£°éŸ³å…‹éš†ï¼‰</td>
                        </tr>
                        <tr>
                            <td style="border: 1px solid #dee2e6; padding: 8px;">age</td>
                            <td style="border: 1px solid #dee2e6; padding: 8px;">string</td>
                            <td style="border: 1px solid #dee2e6; padding: 8px;" data-i18n="required-no">å¦</td>
                            <td style="border: 1px solid #dee2e6; padding: 8px;" data-i18n="age-options">å¹´é¾„ï¼šchild, teenager, youth-adult, middle-aged, elderly</td>
                        </tr>
                        <tr>
                            <td style="border: 1px solid #dee2e6; padding: 8px;">gender</td>
                            <td style="border: 1px solid #dee2e6; padding: 8px;">string</td>
                            <td style="border: 1px solid #dee2e6; padding: 8px;" data-i18n="required-no">å¦</td>
                            <td style="border: 1px solid #dee2e6; padding: 8px;" data-i18n="gender-options">æ€§åˆ«ï¼šmale, female</td>
                        </tr>
                        <tr>
                            <td style="border: 1px solid #dee2e6; padding: 8px;">emotion</td>
                            <td style="border: 1px solid #dee2e6; padding: 8px;">string</td>
                            <td style="border: 1px solid #dee2e6; padding: 8px;" data-i18n="required-no">å¦</td>
                            <td style="border: 1px solid #dee2e6; padding: 8px;" data-i18n="emotion-options">æƒ…æ„Ÿï¼šUNKNOWN, NEUTRAL, ANGRY, HAPPY, SAD, FEARFUL, DISGUSTED, SURPRISED, SARCASTIC, EXCITED, SLEEPY, CONFUSED, EMPHASIS, LAUGHING, SINGING, WORRIED, WHISPER, ANXIOUS, NO-AGREEMENT, APOLOGETIC, CONCERNED, ENUNCIATED, ASSERTIVE, ENCOURAGING, CONTEMPT</td>
                        </tr>
                        <tr>
                            <td style="border: 1px solid #dee2e6; padding: 8px;">pitch</td>
                            <td style="border: 1px solid #dee2e6; padding: 8px;">string</td>
                            <td style="border: 1px solid #dee2e6; padding: 8px;" data-i18n="required-no">å¦</td>
                            <td style="border: 1px solid #dee2e6; padding: 8px;" data-i18n="pitch-options">éŸ³è°ƒï¼šlow_pitch, medium_pitch, high_pitch, very_high_pitch</td>
                        </tr>
                    </table>
                    
                    <h5 style="margin-top: 20px; margin-bottom: 10px;" data-i18n="request-example">è¯·æ±‚ç¤ºä¾‹ï¼š</h5>
                    <pre style="background: #f8f9fa; padding: 15px; border-radius: 5px; overflow-x: auto; font-size: 14px;"><code>{
  "text": "ä½ å¥½ï¼Œè¿™æ˜¯ä¸€ä¸ªè¯­éŸ³åˆæˆæµ‹è¯•ã€‚",
  "temperature": 1.0,
  "top_p": 0.9,
  "speed": 1.0,
  // æˆ–ä½¿ç”¨å­—ç¬¦ä¸²ç±»å‹
  // "speed": "medium",
  "age": "youth-adult",
  "gender": "female",
  "emotion": "HAPPY",
  "pitch": "medium_pitch"
}</code></pre>
                    
                    <h5 style="margin-top: 20px; margin-bottom: 10px;" data-i18n="response-format">å“åº”æ ¼å¼ï¼š</h5>
                    <pre style="background: #f8f9fa; padding: 15px; border-radius: 5px; overflow-x: auto; font-size: 14px;"><code>{
  "success": true,
  "audio_base64": "UklGRi...",
  "duration_ms": 1234,
  "rtf": 0.123
}</code></pre>
                </div>
                
                <div style="background: white; padding: 20px; border-radius: 8px; margin-bottom: 20px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                    <h4 style="color: #667eea; margin-bottom: 15px;" data-i18n="voice-clone-api-title">ğŸ­ å£°éŸ³å…‹éš† API</h4>
                    
                    <!-- API 1: æå–éŸ³è‰²ç‰¹å¾ -->
                    <div style="border: 1px solid #e0e0e0; border-radius: 8px; padding: 20px; margin: 20px 0; background: #fafafa;">
                        <h5 style="margin-top: 0; margin-bottom: 15px; color: #2c3e50; border-bottom: 2px solid #667eea; padding-bottom: 8px;" data-i18n="extract-voice-title">1. æå–éŸ³è‰²ç‰¹å¾</h5>
                        <p><strong data-i18n="api-endpoint">æ¥å£åœ°å€ï¼š</strong><code style="background: #e8f4fd; padding: 2px 6px; border-radius: 3px;">POST /api/voice-clone/extract</code></p>
                        <p><strong data-i18n="request-format">è¯·æ±‚æ ¼å¼ï¼š</strong><code style="background: #e8f4fd; padding: 2px 6px; border-radius: 3px;">multipart/form-data</code></p>
                        <p><strong data-i18n="api-params">å‚æ•°ï¼š</strong><span data-i18n="extract-params-desc">audio_file (éŸ³é¢‘æ–‡ä»¶), prompt (éŸ³é¢‘å†…å®¹), voice_name (éŸ³è‰²åç§°)</span></p>
                    </div>
                    
                    <!-- API 2: è·å–éŸ³è‰²åˆ—è¡¨ -->
                    <div style="border: 1px solid #e0e0e0; border-radius: 8px; padding: 20px; margin: 20px 0; background: #fafafa;">
                        <h5 style="margin-top: 0; margin-bottom: 15px; color: #2c3e50; border-bottom: 2px solid #667eea; padding-bottom: 8px;" data-i18n="get-voice-list-title">2. è·å–éŸ³è‰²åˆ—è¡¨</h5>
                        <p><strong data-i18n="api-endpoint">æ¥å£åœ°å€ï¼š</strong><code style="background: #e8f4fd; padding: 2px 6px; border-radius: 3px;">GET /api/voice-clone/list</code></p>
                        <p><strong data-i18n="request-method">è¯·æ±‚æ–¹æ³•ï¼š</strong><code style="background: #e8f4fd; padding: 2px 6px; border-radius: 3px;">GET</code></p>
                        <p><strong data-i18n="api-description">è¯´æ˜ï¼š</strong><span data-i18n="get-voice-list-desc">è·å–æ‰€æœ‰å·²ä¿å­˜çš„éŸ³è‰²åˆ—è¡¨</span></p>
                        
                        <h6 style="margin-top: 15px; margin-bottom: 10px; color: #34495e;" data-i18n="response-format">å“åº”æ ¼å¼ï¼š</h6>
                        <pre style="background: #2c3e50; color: #ecf0f1; padding: 15px; border-radius: 5px; overflow-x: auto; font-size: 14px; border-left: 4px solid #667eea;"><code>{
  "voices": [
    {
      "id": "voice_001",
      "name": "å¼ ä¸‰çš„å£°éŸ³",
      "description": "æ¸©å’Œçš„ç”·æ€§å£°éŸ³",
      "created_at": "2024-01-01T12:00:00Z"
    },
    {
      "id": "voice_002",
      "name": "æå››çš„å£°éŸ³",
      "description": "æ¸…è„†çš„å¥³æ€§å£°éŸ³",
      "created_at": "2024-01-02T12:00:00Z"
    }
  ]
}</code></pre>
                        
                        <h6 style="margin-top: 15px; margin-bottom: 10px; color: #34495e;" data-i18n="curl-example">cURL ç¤ºä¾‹ï¼š</h6>
                        <pre style="background: #27ae60; color: white; padding: 15px; border-radius: 5px; overflow-x: auto; font-size: 14px; border-left: 4px solid #2ecc71;"><code>curl -X GET http://localhost:8080/api/voice-clone/list</code></pre>
                    </div>
                    
                    <!-- API 3: åˆ é™¤éŸ³è‰² -->
                    <div style="border: 1px solid #e0e0e0; border-radius: 8px; padding: 20px; margin: 20px 0; background: #fafafa;">
                        <h5 style="margin-top: 0; margin-bottom: 15px; color: #2c3e50; border-bottom: 2px solid #667eea; padding-bottom: 8px;" data-i18n="delete-voice-title">3. åˆ é™¤éŸ³è‰²</h5>
                        <p><strong data-i18n="api-endpoint">æ¥å£åœ°å€ï¼š</strong><code style="background: #e8f4fd; padding: 2px 6px; border-radius: 3px;">POST /api/voice-clone/delete</code></p>
                        <p><strong data-i18n="request-method">è¯·æ±‚æ–¹æ³•ï¼š</strong><code style="background: #e8f4fd; padding: 2px 6px; border-radius: 3px;">POST</code></p>
                        <p><strong data-i18n="request-format">è¯·æ±‚æ ¼å¼ï¼š</strong><code style="background: #e8f4fd; padding: 2px 6px; border-radius: 3px;">JSON</code></p>
                        <p><strong data-i18n="api-params">å‚æ•°ï¼š</strong><code style="background: #fff3cd; padding: 2px 6px; border-radius: 3px;" data-i18n="delete-params-desc">{"voice_id": "éŸ³è‰²ID"}</code></p>
                        <p><strong data-i18n="api-description">è¯´æ˜ï¼š</strong><span data-i18n="delete-voice-desc">åˆ é™¤æŒ‡å®šIDçš„éŸ³è‰²</span></p>
                        
                        <h6 style="margin-top: 15px; margin-bottom: 10px; color: #34495e;" data-i18n="curl-example">cURL ç¤ºä¾‹ï¼š</h6>
                        <pre style="background: #e74c3c; color: white; padding: 15px; border-radius: 5px; overflow-x: auto; font-size: 14px; border-left: 4px solid #c0392b;"><code>curl -X POST http://localhost:8080/api/voice-clone/delete \
  -H "Content-Type: application/json" \
  -d '{"voice_id": "voice_001"}'</code></pre>
                    </div>
                </div>
                

            </div>
        </div>
    </div>

    <script>


        // é¡µé¢åŠ è½½æ—¶åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            loadVoiceList();
            setupVoiceUpload();
            setupVoiceSelectListener();
        });

        // è¡¨å•æäº¤å¤„ç†
        document.getElementById('ttsForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const formData = new FormData(e.target);
            const text = formData.get('text').trim();
            
            if (!text) {
                showResult('è¯·è¾“å…¥è¦è½¬æ¢çš„æ–‡æœ¬', 'error');
                return;
            }

            // è¯»å– seed
            const seedRaw = (formData.get('seed') || '').toString().trim();
            const seed = seedRaw === '' ? null : Number(seedRaw);

            // æ£€æŸ¥æ˜¯å¦é€‰æ‹©äº†éŸ³è‰²
            const selectedVoice = formData.get('voiceSelect');
            
            const requestData = {
                text: text,
                temperature: parseFloat(formData.get('temperature')) || 1.0,
                top_p: parseFloat(formData.get('topP')) || 0.9,
                speed: formData.get('speed') || 'medium',
                seed: seed,
                age: formData.get('age') || 'youth-adult',
                gender: formData.get('gender') || 'male',
                emotion: formData.get('emotion') || 'NEUTRAL',
                pitch: formData.get('pitch') || 'medium_pitch'
            };

            // å¦‚æœé€‰æ‹©äº†éŸ³è‰²ï¼Œæ·»åŠ voice_idå‚æ•°
            if (selectedVoice && selectedVoice !== 'none') {
                requestData.voice_id = selectedVoice;
            }

            // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
            showLoading(true);
            hideResult();

            try {
                const response = await fetch('/api/tts', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(requestData)
                });

                const result = await response.json();

                if (result.success && result.audio_base64) {
                    // åˆ›å»ºéŸ³é¢‘æ’­æ”¾å™¨
                    const audioBlob = base64ToBlob(result.audio_base64, 'audio/wav');
                    const audioUrl = URL.createObjectURL(audioBlob);
                    
                    const audioHtml = `
                        <audio controls>
                            <source src="${audioUrl}" type="audio/wav">
                            æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒéŸ³é¢‘æ’­æ”¾ã€‚
                        </audio>
                        <div style="margin-top: 10px;">
                            <a href="${audioUrl}" download="tts_output.wav" style="color: #667eea; text-decoration: none;">
                                ğŸ“¥ ä¸‹è½½éŸ³é¢‘æ–‡ä»¶
                            </a>
                        </div>
                    `;
                    
                    showResult(
                        `âœ… è¯­éŸ³ç”ŸæˆæˆåŠŸï¼è€—æ—¶: ${result.duration_ms}ms, RTF: ${result.rtf?.toFixed(3) || 'N/A'}`,
                        'success',
                        audioHtml
                    );
                } else {
                    showResult(`âŒ ${result.error || result.message || 'ç”Ÿæˆå¤±è´¥'}`, 'error');
                }
            } catch (error) {
                showResult(`âŒ ç½‘ç»œé”™è¯¯: ${error.message}`, 'error');
            } finally {
                showLoading(false);
            }
        });

        // æ˜¾ç¤º/éšè—åŠ è½½çŠ¶æ€
        function showLoading(show) {
            const loading = document.getElementById('loading');
            const btn = document.getElementById('generateBtn');
            
            if (loading && btn) {
                if (show) {
                    loading.style.display = 'block';
                    btn.disabled = true;
                    btn.textContent = 'ğŸ”„ ç”Ÿæˆä¸­...';
                } else {
                    loading.style.display = 'none';
                    btn.disabled = false;
                    btn.textContent = 'ğŸµ ç”Ÿæˆè¯­éŸ³';
                }
            }
        }

        // æ˜¾ç¤ºç»“æœ
        function showResult(message, type = 'success', audioHtml = '') {
            const result = document.getElementById('result');
            const resultMessage = document.getElementById('resultMessage');
            const audioPlayer = document.getElementById('audioPlayer');
            
            if (result && resultMessage && audioPlayer) {
                result.className = `result ${type}`;
                result.style.display = 'block';
                resultMessage.textContent = message;
                audioPlayer.innerHTML = audioHtml;
            }
        }

        // éšè—ç»“æœ
        function hideResult() {
            const result = document.getElementById('result');
            if (result) {
                result.style.display = 'none';
            }
        }

        // Base64è½¬Blob
        function base64ToBlob(base64, mimeType) {
            const byteCharacters = atob(base64);
            const byteNumbers = new Array(byteCharacters.length);
            
            for (let i = 0; i < byteCharacters.length; i++) {
                byteNumbers[i] = byteCharacters.charCodeAt(i);
            }
            
            const byteArray = new Uint8Array(byteNumbers);
            return new Blob([byteArray], { type: mimeType });
        }

        // æ ‡ç­¾åˆ‡æ¢å‡½æ•°
        function switchTab(tabName) {
            // éšè—æ‰€æœ‰æ ‡ç­¾å†…å®¹
            const contents = document.querySelectorAll('.tab-content');
            contents.forEach(content => {
                content.classList.remove('active');
            });
            
            // ç§»é™¤æ‰€æœ‰æ ‡ç­¾çš„activeçŠ¶æ€
            const tabs = document.querySelectorAll('.tab-button');
            tabs.forEach(tab => {
                tab.classList.remove('active');
            });
            
            // æ˜¾ç¤ºé€‰ä¸­çš„æ ‡ç­¾å†…å®¹
            const targetContent = document.getElementById(tabName);
            if (targetContent) {
                targetContent.classList.add('active');
            }
            
            // æ¿€æ´»é€‰ä¸­çš„æ ‡ç­¾
            const targetTab = document.querySelector(`[data-tab="${tabName}"]`);
            if (targetTab) {
                targetTab.classList.add('active');
            }
        }

        // é«˜çº§é€‰é¡¹ç°åœ¨é»˜è®¤æ˜¾ç¤ºï¼Œæ ¹æ®éŸ³è‰²é€‰æ‹©è‡ªåŠ¨éšè—/æ˜¾ç¤º

        // è®¾ç½®éŸ³è‰²é€‰æ‹©ç›‘å¬å™¨
        function setupVoiceSelectListener() {
            const voiceSelect = document.getElementById('voiceSelect');
            const advancedContent = document.getElementById('advancedContent');
            
            if (voiceSelect && advancedContent) {
                voiceSelect.addEventListener('change', function() {
                    const selectedValue = this.value;
                    
                    if (selectedValue === 'none') {
                        // é€‰æ‹©é»˜è®¤éŸ³è‰²æ—¶ï¼Œæ˜¾ç¤ºé«˜çº§é€‰é¡¹
                        advancedContent.classList.remove('hidden');
                    } else {
                        // é€‰æ‹©å…¶ä»–éŸ³è‰²æ—¶ï¼Œéšè—é«˜çº§é€‰é¡¹
                        advancedContent.classList.add('hidden');
                    }
                });
            }
        }



        // å…¨å±€å˜é‡å­˜å‚¨å½“å‰é€‰æ‹©çš„æ–‡ä»¶
        let currentSelectedFile = null;
        let currentBlobURL = null;

        // æ¸…ç†blob URLçš„è¾…åŠ©å‡½æ•°
        function cleanupBlobURL() {
            if (currentBlobURL) {
                try {
                    URL.revokeObjectURL(currentBlobURL);
                    console.log('æ¸…ç†blob URL:', currentBlobURL);
                } catch (error) {
                    console.warn('æ¸…ç†blob URLæ—¶å‡ºé”™:', error);
                }
                currentBlobURL = null;
            }
        }
        
        // æ¸…ç†æ‰€æœ‰éŸ³é¢‘èµ„æºçš„å‡½æ•°
        function cleanupAudioResources() {
            cleanupBlobURL();
            if (window.currentWaveSurfer) {
                window.currentWaveSurfer.destroy();
                window.currentWaveSurfer = null;
            }
        }

        // é¡µé¢å¸è½½æ—¶æ¸…ç†èµ„æº
        window.addEventListener('beforeunload', () => {
            cleanupAudioResources();
        });

        // è®¾ç½®éŸ³è‰²ä¸Šä¼ åŠŸèƒ½
        function setupVoiceUpload() {
            const uploadArea = document.getElementById('voiceUpload');
            const fileInput = document.getElementById('voiceFile');
            const fileInfo = document.getElementById('fileInfo');
            const fileName = document.getElementById('fileName');
            const fileSize = document.getElementById('fileSize');

            if (!uploadArea || !fileInput) return;

            // ç§»é™¤å¯èƒ½å­˜åœ¨çš„æ—§äº‹ä»¶ç›‘å¬å™¨
            const newUploadArea = uploadArea.cloneNode(true);
            uploadArea.parentNode.replaceChild(newUploadArea, uploadArea);
            const newFileInput = fileInput.cloneNode(true);
            fileInput.parentNode.replaceChild(newFileInput, fileInput);
            
            // é‡æ–°è·å–å…ƒç´ å¼•ç”¨
            const freshUploadArea = document.getElementById('voiceUpload');
            const freshFileInput = document.getElementById('voiceFile');

            // ç‚¹å‡»ä¸Šä¼ åŒºåŸŸ
            freshUploadArea.addEventListener('click', (e) => {
                // é˜²æ­¢é‡å¤è§¦å‘
                e.stopPropagation();
                freshFileInput.click();
            });

            // æ–‡ä»¶é€‰æ‹©
            freshFileInput.addEventListener('change', (e) => {
                const file = e.target.files[0];
                if (file) {
                    currentSelectedFile = file;
                    displayFileInfo(file);
                }
            });

            // æ‹–æ‹½ä¸Šä¼ 
            freshUploadArea.addEventListener('dragover', (e) => {
                e.preventDefault();
                freshUploadArea.classList.add('dragover');
            });

            freshUploadArea.addEventListener('dragleave', () => {
                freshUploadArea.classList.remove('dragover');
            });

            freshUploadArea.addEventListener('drop', (e) => {
                e.preventDefault();
                freshUploadArea.classList.remove('dragover');
                
                const files = e.dataTransfer.files;
                if (files.length > 0) {
                    const file = files[0];
                    if (file.type.startsWith('audio/')) {
                        // å­˜å‚¨æ–‡ä»¶åˆ°å…¨å±€å˜é‡
                        currentSelectedFile = file;
                        // ç›´æ¥è°ƒç”¨displayFileInfoï¼Œä¸è®¾ç½®fileInput.filesé¿å…é‡å¤è§¦å‘changeäº‹ä»¶
                        displayFileInfo(file);
                    } else {
                        alert('è¯·é€‰æ‹©éŸ³é¢‘æ–‡ä»¶');
                    }
                }
            });

            function displayFileInfo(file) {
                if (fileName && fileSize && fileInfo) {
                    fileName.textContent = `æ–‡ä»¶å: ${file.name}`;
                    fileSize.textContent = `å¤§å°: ${(file.size / 1024 / 1024).toFixed(2)} MB`;
                    fileInfo.classList.add('show');
                    
                    // æ˜¾ç¤ºéŸ³é¢‘æ’­æ”¾å™¨
                    const audioPlayer = document.getElementById('audioPreviewPlayer');
                    const waveformContainer = document.getElementById('waveform');
                    const playPauseBtn = document.getElementById('playPauseBtn');
                    const audioTime = document.getElementById('audioTime');
                    
                    if (audioPlayer && waveformContainer) {
                        // ä½¿ç”¨å…¨å±€æ¸…ç†å‡½æ•°
                        cleanupBlobURL();
                        
                        // é”€æ¯ä¹‹å‰çš„wavesurferå®ä¾‹
                        if (window.currentWaveSurfer) {
                            window.currentWaveSurfer.destroy();
                            window.currentWaveSurfer = null;
                        }
                        
                        try {
                            // åˆ›å»ºæ–°çš„blob URL
                            currentBlobURL = URL.createObjectURL(file);
                            console.log('åˆ›å»ºæ–°çš„blob URL:', currentBlobURL);
                            
                            // åˆ›å»ºWaveSurferå®ä¾‹
                            window.currentWaveSurfer = WaveSurfer.create({
                                container: waveformContainer,
                                waveColor: '#667eea',
                                progressColor: '#764ba2',
                                cursorColor: '#333',
                                barWidth: 2,
                                barRadius: 3,
                                responsive: true,
                                height: 80,
                                normalize: true
                            });
                            
                            // åŠ è½½éŸ³é¢‘æ–‡ä»¶
                            window.currentWaveSurfer.load(currentBlobURL);
                            
                            // ç›‘å¬åŠ è½½å®Œæˆäº‹ä»¶
                            window.currentWaveSurfer.on('ready', () => {
                                console.log('éŸ³é¢‘åŠ è½½å®Œæˆ');
                                audioPlayer.style.display = 'block';
                                updateTimeDisplay();
                            });
                            
                            // ç›‘å¬æ’­æ”¾è¿›åº¦
                            window.currentWaveSurfer.on('audioprocess', updateTimeDisplay);
                            window.currentWaveSurfer.on('seek', updateTimeDisplay);
                            
                            // ç›‘å¬æ’­æ”¾çŠ¶æ€å˜åŒ–
                            window.currentWaveSurfer.on('play', () => {
                                const texts = i18nTexts[currentLanguage];
                    playPauseBtn.textContent = 'â¸ï¸ ' + texts['pause-btn'];
                            });
                            
                            window.currentWaveSurfer.on('pause', () => {
                                const texts = i18nTexts[currentLanguage];
                        playPauseBtn.textContent = 'â–¶ï¸ ' + texts['play-btn'];
                            });
                            
                            window.currentWaveSurfer.on('finish', () => {
                                const texts = i18nTexts[currentLanguage];
                    playPauseBtn.textContent = 'â–¶ï¸ ' + texts['play-btn'];
                            });
                            
                            // ç›‘å¬é”™è¯¯ - æ·»åŠ æ›´ç²¾ç¡®çš„é”™è¯¯åˆ¤æ–­
                            window.currentWaveSurfer.on('error', (error) => {
                                console.error('WaveSurferé”™è¯¯:', error);
                                
                                // æ£€æŸ¥æ˜¯å¦æ˜¯çœŸæ­£çš„åŠ è½½é”™è¯¯
                                setTimeout(() => {
                                    if (window.currentWaveSurfer && window.currentWaveSurfer.getDuration() > 0) {
                                        // å®é™…ä¸ŠåŠ è½½æˆåŠŸäº†ï¼Œä¸æ˜¾ç¤ºé”™è¯¯
                                        console.log('éŸ³é¢‘å®é™…åŠ è½½æˆåŠŸï¼Œå¿½ç•¥é”™è¯¯äº‹ä»¶');
                                        return;
                                    }
                                    
                                    // çœŸæ­£çš„åŠ è½½å¤±è´¥
                                    console.error('éŸ³é¢‘åŠ è½½å¤±è´¥:', error);
                                    cleanupBlobURL();
                                    audioPlayer.style.display = 'none';
                                    alert('éŸ³é¢‘æ–‡ä»¶åŠ è½½å¤±è´¥ï¼Œè¯·æ£€æŸ¥æ–‡ä»¶æ ¼å¼æ˜¯å¦æ­£ç¡®');
                                }, 100);
                            });
                            
                            // æ’­æ”¾/æš‚åœæŒ‰é’®äº‹ä»¶
                            if (playPauseBtn) {
                                playPauseBtn.onclick = () => {
                                    if (window.currentWaveSurfer) {
                                        window.currentWaveSurfer.playPause();
                                    }
                                };
                            }
                            
                            // æ—¶é—´æ˜¾ç¤ºæ›´æ–°å‡½æ•°
                            function updateTimeDisplay() {
                                if (window.currentWaveSurfer && audioTime) {
                                    const current = window.currentWaveSurfer.getCurrentTime();
                                    const total = window.currentWaveSurfer.getDuration();
                                    audioTime.textContent = `${formatTime(current)} / ${formatTime(total)}`;
                                }
                            }
                            
                            // æ—¶é—´æ ¼å¼åŒ–å‡½æ•°
                            function formatTime(seconds) {
                                const minutes = Math.floor(seconds / 60);
                                const secs = Math.floor(seconds % 60);
                                return `${minutes.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
                            }
                            
                        } catch (error) {
                            console.error('åˆ›å»ºwavesurferå¤±è´¥:', error);
                            alert('æ–‡ä»¶å¤„ç†å¤±è´¥ï¼Œè¯·é‡è¯•');
                            cleanupBlobURL();
                        }
                    }
                }
            }
        }

        // æå–éŸ³è‰²ç‰¹å¾
        async function extractVoiceFeature() {
            const fileInput = document.getElementById('voiceFile');
            const voicePrompt = document.getElementById('voicePrompt');
            const voiceName = document.getElementById('voiceName');
            const extractBtn = document.getElementById('extractBtn');
            const cloneResult = document.getElementById('cloneResult');
            const cloneMessage = document.getElementById('cloneMessage');

            if (!fileInput || !voicePrompt || !voiceName || !extractBtn || !cloneResult || !cloneMessage) {
                console.error('Required elements not found');
                return;
            }

            // ä½¿ç”¨å…¨å±€å˜é‡è·å–æ–‡ä»¶
            const file = currentSelectedFile;
            const prompt = voicePrompt.value.trim();
            const name = voiceName.value.trim();

            if (!file) {
                showCloneResult('è¯·å…ˆä¸Šä¼ éŸ³é¢‘æ–‡ä»¶', 'error');
                return;
            }

            if (!prompt) {
                showCloneResult('è¯·è¾“å…¥éŸ³é¢‘å†…å®¹', 'error');
                return;
            }

            if (!name) {
                showCloneResult('è¯·è¾“å…¥éŸ³è‰²åç§°', 'error');
                return;
            }

            // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
            extractBtn.disabled = true;
            extractBtn.textContent = 'ğŸ”„ æå–ä¸­...';
            cloneResult.style.display = 'none';

            try {
                const formData = new FormData();
                formData.append('audio_file', file);
                formData.append('prompt_text', prompt);
                formData.append('voice_name', name);

                const response = await fetch('/api/voice-clone/extract', {
                    method: 'POST',
                    body: formData
                });

                const result = await response.json();

                if (result.success) {
                    showCloneResult(`âœ… éŸ³è‰²ç‰¹å¾æå–æˆåŠŸï¼éŸ³è‰²ID: ${result.voice_id}`, 'success');
                    // æ¸…ç©ºè¡¨å•
                    fileInput.value = '';
                    voicePrompt.value = '';
                    voiceName.value = '';
                    currentSelectedFile = null;
                    document.getElementById('fileInfo').classList.remove('show');
                    
                    // éšè—éŸ³é¢‘æ’­æ”¾å™¨å¹¶æ¸…ç†èµ„æº
                    const audioPlayer = document.getElementById('audioPreviewPlayer');
                    if (audioPlayer) {
                        audioPlayer.style.display = 'none';
                        
                        // ä½¿ç”¨å…¨å±€æ¸…ç†å‡½æ•°
                        cleanupBlobURL();
                        
                        // é”€æ¯wavesurferå®ä¾‹
                        if (window.currentWaveSurfer) {
                            window.currentWaveSurfer.destroy();
                            window.currentWaveSurfer = null;
                        }
                        
                        // é‡ç½®æ’­æ”¾æŒ‰é’®æ–‡æœ¬
            const playPauseBtn = document.getElementById('playPauseBtn');
            if (playPauseBtn) {
                const texts = i18nTexts[currentLanguage];
                playPauseBtn.textContent = 'â–¶ï¸ ' + texts['play-btn'];
            }
                        
                        // é‡ç½®æ—¶é—´æ˜¾ç¤º
                        const audioTime = document.getElementById('audioTime');
                        if (audioTime) {
                            audioTime.textContent = '00:00 / 00:00';
                        }
                    }
                    // é‡æ–°åŠ è½½éŸ³è‰²åˆ—è¡¨
                    await loadVoiceList();
                } else {
                    showCloneResult(`âŒ ${result.error || 'æå–å¤±è´¥'}`, 'error');
                }
            } catch (error) {
                showCloneResult(`âŒ ç½‘ç»œé”™è¯¯: ${error.message}`, 'error');
            } finally {
                extractBtn.disabled = false;
                extractBtn.textContent = 'ğŸ­ æå–éŸ³è‰²ç‰¹å¾';
            }
        }

        // æ˜¾ç¤ºå…‹éš†ç»“æœ
        function showCloneResult(message, type = 'success') {
            const cloneResult = document.getElementById('cloneResult');
            const cloneMessage = document.getElementById('cloneMessage');
            
            if (cloneResult && cloneMessage) {
                cloneResult.className = `result ${type}`;
                cloneResult.style.display = 'block';
                cloneMessage.textContent = message;
            }
        }

        // åŠ è½½éŸ³è‰²åˆ—è¡¨
        async function loadVoiceList() {
            try {
                const response = await fetch('/api/voice-clone/list');
                const result = await response.json();

                if (result.success) {
                    updateVoiceSelect(result.voices);
                    updateVoiceListDisplay(result.voices);
                }
            } catch (error) {
                console.warn('æ— æ³•åŠ è½½éŸ³è‰²åˆ—è¡¨:', error);
            }
        }

        // æ›´æ–°éŸ³è‰²é€‰æ‹©ä¸‹æ‹‰æ¡†
        function updateVoiceSelect(voices) {
            const voiceSelect = document.getElementById('voiceSelect');
            if (!voiceSelect) return;

            // ä¿ç•™é»˜è®¤é€‰é¡¹
            voiceSelect.innerHTML = '<option value="none" data-i18n="default-voice">é»˜è®¤éŸ³è‰²</option>';
            
            voices.forEach(voice => {
                const option = document.createElement('option');
                option.value = voice.id;
                option.textContent = voice.name;
                voiceSelect.appendChild(option);
            });
        }

        // æ›´æ–°éŸ³è‰²åˆ—è¡¨æ˜¾ç¤º
        function updateVoiceListDisplay(voices) {
            const voiceList = document.getElementById('voiceList');
            if (!voiceList) return;

            if (voices.length === 0) {
                voiceList.innerHTML = '<div style="padding: 20px; text-align: center; color: #6c757d;">æš‚æ— ä¿å­˜çš„éŸ³è‰²</div>';
                return;
            }

            voiceList.innerHTML = '';
            voices.forEach(voice => {
                const item = document.createElement('div');
                item.className = 'voice-item';
                item.innerHTML = `
                    <div class="voice-name">${voice.name}</div>
                    <div class="voice-actions">
                        <button class="btn-small btn-danger" onclick="deleteVoice('${voice.id}')" data-i18n="delete-btn">
                            ${i18nTexts[currentLanguage]['delete-btn']}
                        </button>
                    </div>
                `;
                voiceList.appendChild(item);
            });
        }

        // åˆ é™¤éŸ³è‰²
        async function deleteVoice(voiceId) {
            const texts = i18nTexts[currentLanguage];
            if (!confirm(texts['delete-confirm'])) {
                return;
            }

            try {
                const response = await fetch('/api/voice-clone/delete', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ voice_id: voiceId })
                });

                const result = await response.json();

                if (result.success) {
                    showCloneResult(texts['delete-success'], 'success');
                    await loadVoiceList();
                } else {
                    showCloneResult(`âŒ ${result.error || texts['delete-failed']}`, 'error');
                }
            } catch (error) {
                showCloneResult(`âŒ ${texts['network-error']}: ${error.message}`, 'error');
            }
        }

        // å¤šè¯­è¨€æ–‡æœ¬å¯¹è±¡
        const i18nTexts = {
            'zh': {
                'title': 'ğŸµ RWKV TTS',
                'subtitle': 'åŸºäº RWKV çš„é«˜è´¨é‡è¯­éŸ³åˆæˆæœåŠ¡',
                'lang-switch': 'ä¸­æ–‡',
                'tab-tts': 'ğŸµ è¯­éŸ³ç”Ÿæˆ',
                'tab-clone': 'ğŸ­ å£°éŸ³å…‹éš†',
                'tab-api': 'ğŸ“– APIè¯´æ˜',
                'input-text': 'è¾“å…¥æ–‡æœ¬',
                'ipa-coming-soon': 'IPA å³å°†æ”¯æŒ',
                'text-placeholder': 'è¯·è¾“å…¥è¦è½¬æ¢ä¸ºè¯­éŸ³çš„æ–‡æœ¬...',
                'voice-select': 'é€‰æ‹©éŸ³è‰²',
                'default-voice': 'é»˜è®¤éŸ³è‰²',

                'temperature': 'Temperature',
                'top-p': 'Top P',
                'speed': 'è¯­é€Ÿ',
                'seed': 'éšæœºç§å­',
                'seed-placeholder': 'ç•™ç©ºä¸ºéšæœº',
                'very-slow': 'å¾ˆæ…¢',
                'slow': 'æ…¢',
                'medium': 'ä¸­é€Ÿ',
                'fast': 'å¿«',
                'very-fast': 'å¾ˆå¿«',
                'age': 'å¹´é¾„',
                'gender': 'æ€§åˆ«',
                'emotion': 'æƒ…æ„Ÿ',
                'pitch': 'éŸ³è°ƒ',
                'generate-btn': 'ğŸµ ç”Ÿæˆè¯­éŸ³',
                'generating': 'ğŸ”„ ç”Ÿæˆä¸­...',
                'loading-text': 'ğŸ”„ æ­£åœ¨ç”Ÿæˆè¯­éŸ³ï¼Œè¯·ç¨å€™...',
                'download-audio': 'ğŸ“¥ ä¸‹è½½éŸ³é¢‘æ–‡ä»¶',
                // å¹´é¾„é€‰é¡¹
                'child': 'å„¿ç«¥',
                'teenager': 'é’å°‘å¹´',
                'youth-adult': 'é’å¹´-æˆå¹´',
                'middle-aged': 'ä¸­å¹´',
                'elderly': 'è€å¹´',
                // æ€§åˆ«é€‰é¡¹
                'male': 'ç”·æ€§',
                'female': 'å¥³æ€§',
                // æƒ…æ„Ÿé€‰é¡¹
                'unknown': 'æœªçŸ¥',
                'neutral': 'ä¸­æ€§',
                'angry': 'æ„¤æ€’',
                'happy': 'å¿«ä¹',
                'sad': 'æ‚²ä¼¤',
                'fearful': 'ææƒ§',
                'disgusted': 'åŒæ¶',
                'surprised': 'æƒŠè®¶',
                'sarcastic': 'è®½åˆº',
                'excited': 'å…´å¥‹',
                'sleepy': 'å›°å€¦',
                'confused': 'å›°æƒ‘',
                'emphasis': 'å¼ºè°ƒ',
                'laughing': 'å¤§ç¬‘',
                'singing': 'æ­Œå”±',
                'worried': 'æ‹…å¿§',
                'whisper': 'è€³è¯­',
                'anxious': 'ç„¦è™‘',
                'no-agreement': 'ä¸åŒæ„',
                'apologetic': 'é“æ­‰',
                'concerned': 'å…³åˆ‡',
                'enunciated': 'æ¸…æ™°å‘éŸ³',
                'assertive': 'åšå®š',
                'encouraging': 'é¼“åŠ±',
                'contempt': 'è”‘è§†',
                // éŸ³è°ƒé€‰é¡¹
                'low-pitch': 'ä½éŸ³è°ƒ',
                'medium-pitch': 'ä¸­éŸ³è°ƒ',
                'high-pitch': 'é«˜éŸ³è°ƒ',
                'very-high-pitch': 'æé«˜éŸ³è°ƒ',
                // å£°éŸ³å…‹éš†ç›¸å…³
                'upload-audio': 'ä¸Šä¼ éŸ³é¢‘æ–‡ä»¶',
                'audio-preview': 'éŸ³é¢‘é¢„è§ˆ',
                'audio-content': 'éŸ³é¢‘å†…å®¹',
                'voice-name': 'éŸ³è‰²åç§°',
                'extract-voice': 'æå–éŸ³è‰²ç‰¹å¾',
                'saved-voices': 'å·²ä¿å­˜çš„éŸ³è‰²',
                'play-btn': 'æ’­æ”¾',
                'pause-btn': 'æš‚åœ',
                'delete-confirm': 'ç¡®å®šè¦åˆ é™¤è¿™ä¸ªéŸ³è‰²å—ï¼Ÿ',
                'delete-btn': 'åˆ é™¤',
                'delete-success': 'âœ… éŸ³è‰²åˆ é™¤æˆåŠŸ',
                'delete-failed': 'åˆ é™¤å¤±è´¥',
                'network-error': 'ç½‘ç»œé”™è¯¯',
                'audio-content-placeholder': 'è¯·è¾“å…¥éŸ³é¢‘ä¸­è¯´è¯çš„æ–‡å­—å†…å®¹...',
                'voice-name-placeholder': 'ä¸ºè¿™ä¸ªéŸ³è‰²èµ·ä¸€ä¸ªåå­—',
                // æ–‡ä»¶ä¸Šä¼ åŒºåŸŸ
                'upload-drop-text': 'ç‚¹å‡»æˆ–æ‹–æ‹½éŸ³é¢‘æ–‡ä»¶åˆ°æ­¤å¤„',
                'upload-hint-text': 'æ”¯æŒ WAV, MP3 æ ¼å¼ï¼Œå»ºè®®æ—¶é•¿ 3-30 ç§’',
                // APIè¯´æ˜é¡µé¢
                'api-title': 'ğŸ“– API æ¥å£è¯´æ˜',
                'tts-api-title': 'ğŸµ TTS è¯­éŸ³åˆæˆ API',
                'voice-clone-api-title': 'ğŸ­ å£°éŸ³å…‹éš† API',
                'api-endpoint': 'æ¥å£åœ°å€ï¼š',
                'request-format': 'è¯·æ±‚æ ¼å¼ï¼š',
                'request-method': 'è¯·æ±‚æ–¹æ³•ï¼š',
                'request-params': 'è¯·æ±‚å‚æ•°ï¼š',
                'request-example': 'è¯·æ±‚ç¤ºä¾‹ï¼š',
                'response-format': 'å“åº”æ ¼å¼ï¼š',
                'curl-example': 'cURL ç¤ºä¾‹ï¼š',
                'description': 'è¯´æ˜ï¼š',
                'param-name': 'å‚æ•°å',
                'param-type': 'ç±»å‹',
                'param-required': 'å¿…å¡«',
                'param-description': 'è¯´æ˜',
                'required-yes': 'æ˜¯',
                'required-no': 'å¦',
                'text-content': 'è¦è½¬æ¢çš„æ–‡æœ¬å†…å®¹',
                'sampling-temperature': 'é‡‡æ ·æ¸©åº¦ï¼Œé»˜è®¤1.0',
                'top-p-sampling': 'Top-pé‡‡æ ·ï¼Œé»˜è®¤0.9',
                'speech-speed': 'è¯­é€Ÿï¼Œé»˜è®¤1.0',
                'random-seed': 'éšæœºç§å­ï¼Œå¯é€‰',
                'voice-id': 'éŸ³è‰²IDï¼ˆå£°éŸ³å…‹éš†ï¼‰',
                'age-options': 'å¹´é¾„ï¼šyouth-adult, middle-aged, elderly',
                'gender-options': 'æ€§åˆ«ï¼šmale, female',
                'emotion-options': 'æƒ…æ„Ÿï¼šNEUTRAL, HAPPY, SAD, ANGRY, SURPRISED',
                'pitch-options': 'éŸ³è°ƒï¼šlow_pitch, medium_pitch, high_pitch',
                'extract-voice-feature': '1. æå–éŸ³è‰²ç‰¹å¾',
                'get-voice-list': '2. è·å–éŸ³è‰²åˆ—è¡¨',
                'delete-voice': '3. åˆ é™¤éŸ³è‰²',
                'extract-params': 'audio_file (éŸ³é¢‘æ–‡ä»¶), prompt (éŸ³é¢‘å†…å®¹), voice_name (éŸ³è‰²åç§°)',
                'get-all-voices': 'è·å–æ‰€æœ‰å·²ä¿å­˜çš„éŸ³è‰²åˆ—è¡¨',
                'delete-voice-desc': 'åˆ é™¤æŒ‡å®šIDçš„éŸ³è‰²',
                'extract-voice-title': '1. æå–éŸ³è‰²ç‰¹å¾',
                'get-voice-list-title': '2. è·å–éŸ³è‰²åˆ—è¡¨',
                'delete-voice-title': '3. åˆ é™¤éŸ³è‰²',
                'api-params': 'å‚æ•°ï¼š',
                'api-description': 'è¯´æ˜ï¼š',
                'extract-params-desc': 'audio_file (éŸ³é¢‘æ–‡ä»¶), prompt (éŸ³é¢‘å†…å®¹), voice_name (éŸ³è‰²åç§°)',
                'get-voice-list-desc': 'è·å–æ‰€æœ‰å·²ä¿å­˜çš„éŸ³è‰²åˆ—è¡¨',
                'delete-params-desc': '{"voice_id": "éŸ³è‰²ID"}'
            },
            'en': {
                'title': 'ğŸµ RWKV TTS',
                'subtitle': 'High-quality Text-to-Speech service based on RWKV',
                'lang-switch': 'English',
                'tab-tts': 'ğŸµ Text to Speech',
                'tab-clone': 'ğŸ­ Voice Clone',
                'tab-api': 'ğŸ“– API Docs',
                'input-text': 'Input Text',
                'ipa-coming-soon': 'IPA Coming Soon',
                'text-placeholder': 'Please enter the text to convert to speech...',
                'voice-select': 'Select Voice',
                'default-voice': 'Default Voice',

                'temperature': 'Temperature',
                'top-p': 'Top P',
                'speed': 'Speed',
                'seed': 'Random Seed',
                'seed-placeholder': 'Leave empty for random',
                'very-slow': 'Very Slow',
                'slow': 'Slow',
                'medium': 'Medium',
                'fast': 'Fast',
                'very-fast': 'Very Fast',
                'age': 'Age',
                'gender': 'Gender',
                'emotion': 'Emotion',
                'pitch': 'Pitch',
                'generate-btn': 'ğŸµ Generate Speech',
                'generating': 'ğŸ”„ Generating...',
                'loading-text': 'ğŸ”„ Generating speech, please wait...',
                'download-audio': 'ğŸ“¥ Download audio file',
                // Age options
                'child': 'Child',
                'teenager': 'Teenager',
                'youth-adult': 'Youth-Adult',
                'middle-aged': 'Middle-Aged',
                'elderly': 'Elderly',
                // Gender options
                'male': 'Male',
                'female': 'Female',
                // Emotion options
                'unknown': 'Unknown',
                'neutral': 'Neutral',
                'angry': 'Angry',
                'happy': 'Happy',
                'sad': 'Sad',
                'fearful': 'Fearful',
                'disgusted': 'Disgusted',
                'surprised': 'Surprised',
                'sarcastic': 'Sarcastic',
                'excited': 'Excited',
                'sleepy': 'Sleepy',
                'confused': 'Confused',
                'emphasis': 'Emphasis',
                'laughing': 'Laughing',
                'singing': 'Singing',
                'worried': 'Worried',
                'whisper': 'Whisper',
                'anxious': 'Anxious',
                'no-agreement': 'No Agreement',
                'apologetic': 'Apologetic',
                'concerned': 'Concerned',
                'enunciated': 'Enunciated',
                'assertive': 'Assertive',
                'encouraging': 'Encouraging',
                'contempt': 'Contempt',
                // Pitch options
                'low-pitch': 'Low Pitch',
                'medium-pitch': 'Medium Pitch',
                'high-pitch': 'High Pitch',
                'very-high-pitch': 'Very High Pitch',
                // Voice cloning related
                'upload-audio': 'Upload audio file',
                'audio-preview': 'Audio preview',
                'audio-content': 'Audio content',
                'voice-name': 'Voice name',
                'extract-voice': 'Extract voice features',
                'saved-voices': 'Saved voices',
                'play-btn': 'Play',
                'pause-btn': 'Pause',
                'delete-confirm': 'Are you sure to delete this voice?',
                'delete-btn': 'Delete',
                'delete-success': 'âœ… Voice deleted',
                'delete-failed': 'Deletion failed',
                'network-error': 'Network error',
                'audio-content-placeholder': 'Please enter the spoken words in the audio...',
                'voice-name-placeholder': 'Provide a name for this voice',
                // File upload area
                'upload-drop-text': 'Click or drag an audio file here',
                'upload-hint-text': 'Supported formats: WAV, MP3, Recommended length: 3-30 seconds',
                // API documentation page
                'api-title': 'ğŸ“– API Documentation',
                'tts-api-title': 'ğŸµ TTS Text to Speech API',
                'voice-clone-api-title': 'ğŸ­ Voice Clone API',
                'api-endpoint': 'API endpointï¼š',
                'request-format': 'Request formatï¼š',
                'request-method': 'Request methodï¼š',
                'request-params': 'Request parametersï¼š',
                'request-example': 'Request exampleï¼š',
                'response-format': 'Response formatï¼š',
                'curl-example': 'cURL exampleï¼š',
                'description': 'Descriptionï¼š',
                'param-name': 'Parameter',
                'param-type': 'Type',
                'param-required': 'Required',
                'param-description': 'Description',
                'required-yes': 'Yes',
                'required-no': 'No',
                'text-content': 'Text to be converted into speech',
                'sampling-temperature': 'Sampling temperatureï¼Œé»˜è®¤1.0',
                'top-p-sampling': 'Top-p sampling, é»˜è®¤0.9',
                'speech-speed': 'Speech speed, é»˜è®¤1.0',
                'random-seed': 'Random seed (Optional)',
                'voice-id': 'Voice ID (voice cloning)',
                'age-options': 'Ageï¼šyouth-adult, middle-aged, elderly',
                'gender-options': 'Genderï¼šmale, female',
                'emotion-options': 'Emotionï¼šNEUTRAL, HAPPY, SAD, ANGRY, SURPRISED',
                'pitch-options': 'Pitchï¼šlow_pitch, medium_pitch, high_pitch',
                'extract-voice-feature': '1. Extract Voice Feature',
                'get-voice-list': '2. Get Voice List',
                'delete-voice': '3. Delete Voice',
                'extract-params': 'audio_file (audio file), prompt (audio content), voice_name (voice name)',
                'get-all-voices': 'Get the list of saved voices',
                'delete-voice-desc': 'Delete voice specified with a Voice ID',
                'extract-voice-title': '1. Extract Voice Feature',
                'get-voice-list-title': '2. Get Voice List',
                'delete-voice-title': '3. Delete Voice',
                'api-params': 'Parameters:',
                'api-description': 'Description:',
                'extract-params-desc': 'audio_file (audio file), prompt (audio content), voice_name (voice name)',
                'get-voice-list-desc': 'Get the list of saved voices',
                'delete-params-desc': '{"voice_id": "Voice ID"}'
            },
            'en': {
                'generating': 'ğŸ”„ Generating...',
                'loading-text': 'ğŸ”„ Generating speech, please wait...',
                'download-audio': 'ğŸ“¥ Download Audio File',
                // å¹´é¾„é€‰é¡¹
                'child': 'Child',
                'teenager': 'Teenager',
                'youth-adult': 'Youth-Adult',
                'middle-aged': 'Middle-aged',
                'elderly': 'Elderly',
                // æ€§åˆ«é€‰é¡¹
                'male': 'Male',
                'female': 'Female',
                // æƒ…æ„Ÿé€‰é¡¹
                'unknown': 'Unknown',
                'neutral': 'Neutral',
                'angry': 'Angry',
                'happy': 'Happy',
                'sad': 'Sad',
                'fearful': 'Fearful',
                'disgusted': 'Disgusted',
                'surprised': 'Surprised',
                'sarcastic': 'Sarcastic',
                'excited': 'Excited',
                'sleepy': 'Sleepy',
                'confused': 'Confused',
                'emphasis': 'Emphasis',
                'laughing': 'Laughing',
                'singing': 'Singing',
                'worried': 'Worried',
                'whisper': 'Whisper',
                'anxious': 'Anxious',
                'no-agreement': 'No-agreement',
                'apologetic': 'Apologetic',
                'concerned': 'Concerned',
                'enunciated': 'Enunciated',
                'assertive': 'Assertive',
                'encouraging': 'Encouraging',
                'contempt': 'Contempt',
                // éŸ³è°ƒé€‰é¡¹
                'low-pitch': 'Low Pitch',
                'medium-pitch': 'Medium Pitch',
                'high-pitch': 'High Pitch',
                'very-high-pitch': 'Very High Pitch',
                // å£°éŸ³å…‹éš†ç›¸å…³
                'upload-audio': 'Upload Audio File',
                'audio-preview': 'Audio Preview',
                'audio-content': 'Audio Content',
                'voice-name': 'Voice Name',
                'extract-voice': 'Extract Voice Feature',
                'saved-voices': 'Saved Voices',
                'play-btn': 'Play',
                'pause-btn': 'Pause',
                'delete-confirm': 'Are you sure you want to delete this voice?',
                'delete-btn': 'Delete',
                'delete-success': 'âœ… Voice deleted successfully',
                'delete-failed': 'Delete failed',
                'network-error': 'Network error',
                'audio-content-placeholder': 'Please enter the text content of the audio...',
                'voice-name-placeholder': 'Give this voice a name',
                // æ–‡ä»¶ä¸Šä¼ åŒºåŸŸ
                'upload-drop-text': 'Click or drag audio files here',
                'upload-hint-text': 'Supports WAV, MP3 formats, recommended duration 3-30 seconds',
                // APIè¯´æ˜é¡µé¢
                'api-title': 'ğŸ“– API Documentation',
                'tts-api-title': 'ğŸµ TTS Speech Synthesis API',
                'voice-clone-api-title': 'ğŸ­ Voice Cloning API',
                'api-endpoint': 'Endpoint: ',
                'request-format': 'Request Format: ',
                'request-method': 'Request Method: ',
                'request-params': 'Request Parameters: ',
                'request-example': 'Request Example: ',
                'response-format': 'Response Format: ',
                'curl-example': 'cURL Example: ',
                'description': 'Description: ',
                'param-name': 'Parameter',
                'param-type': 'Type',
                'param-required': 'Required',
                'param-description': 'Description',
                'required-yes': 'Yes',
                'required-no': 'No',
                'text-content': 'Text content to convert',
                'sampling-temperature': 'Sampling temperature, default 1.0',
                'top-p-sampling': 'Top-p sampling, default 0.9',
                'speech-speed': 'Speech speed, default 1.0',
                'random-seed': 'Random seed, optional',
                'voice-id': 'Voice ID (for voice cloning)',
                'age-options': 'Age: child, teenager, youth-adult, middle-aged, elderly',
                'gender-options': 'Gender: male, female',
                'emotion-options': 'Emotion: UNKNOWN, NEUTRAL, ANGRY, HAPPY, SAD, FEARFUL, DISGUSTED, SURPRISED, SARCASTIC, EXCITED, SLEEPY, CONFUSED, EMPHASIS, LAUGHING, SINGING, WORRIED, WHISPER, ANXIOUS, NO-AGREEMENT, APOLOGETIC, CONCERNED, ENUNCIATED, ASSERTIVE, ENCOURAGING, CONTEMPT',
                'pitch-options': 'Pitch: low_pitch, medium_pitch, high_pitch, very_high_pitch',
                'extract-voice-feature': '1. Extract Voice Features',
                'get-voice-list': '2. Get Voice List',
                'delete-voice': '3. Delete Voice',
                'extract-params': 'audio_file (audio file), prompt (audio content), voice_name (voice name)',
                'get-all-voices': 'Get all saved voice list',
                'delete-voice-desc': 'Delete voice by specified ID',
                'extract-voice-title': '1. Extract Voice Features',
                'get-voice-list-title': '2. Get Voice List',
                'delete-voice-title': '3. Delete Voice',
                'api-params': 'Parameters: ',
                'api-description': 'Description: ',
                'extract-params-desc': 'audio_file (audio file), prompt (audio content), voice_name (voice name)',
                'get-voice-list-desc': 'Get all saved voice list',
                'delete-params-desc': '{"voice_id": "voice ID"}'
            }
        };

        // å½“å‰è¯­è¨€
        let currentLanguage = 'zh';

        // è¯­è¨€åˆ‡æ¢å‡½æ•°
        function toggleLanguage() {
            currentLanguage = currentLanguage === 'zh' ? 'en' : 'zh';
            updateLanguage();
            saveLanguagePreference();
        }

        // æ›´æ–°é¡µé¢è¯­è¨€
        function updateLanguage() {
            const texts = i18nTexts[currentLanguage];
            
            // æ›´æ–°æ‰€æœ‰å¸¦æœ‰ data-i18n å±æ€§çš„å…ƒç´ 
            document.querySelectorAll('[data-i18n]').forEach(element => {
                const key = element.getAttribute('data-i18n');
                if (texts[key]) {
                    if (element.tagName === 'INPUT' && element.type === 'text') {
                        element.placeholder = texts[key];
                    } else if (element.tagName === 'TEXTAREA') {
                        element.placeholder = texts[key];
                    } else {
                        element.textContent = texts[key];
                    }
                }
            });

            // æ›´æ–°è¯­è¨€åˆ‡æ¢æŒ‰é’®æ–‡æœ¬
            const langText = document.getElementById('langText');
            if (langText) {
                langText.textContent = texts['lang-switch'];
            }

            // æ›´æ–°åŠ¨æ€ç”Ÿæˆçš„å†…å®¹
            updateDynamicContent();
        }

        // æ›´æ–°åŠ¨æ€å†…å®¹
        function updateDynamicContent() {
            const texts = i18nTexts[currentLanguage];
            
            // æ›´æ–°ç”ŸæˆæŒ‰é’®
            const generateBtn = document.getElementById('generateBtn');
            if (generateBtn && !generateBtn.disabled) {
                generateBtn.textContent = texts['generate-btn'];
            }

            // æ›´æ–°åŠ è½½æ–‡æœ¬
            const loadingDiv = document.querySelector('#loading div');
            if (loadingDiv) {
                loadingDiv.textContent = texts['loading-text'];
            }

            // é«˜çº§é€‰é¡¹ç°åœ¨é»˜è®¤æ˜¾ç¤ºï¼Œæ— éœ€åˆ‡æ¢æŒ‰é’®

            // æ›´æ–°åŠ¨æ€ç”Ÿæˆçš„éŸ³è‰²é€‰æ‹©ä¸‹æ‹‰æ¡†ä¸­çš„é»˜è®¤é€‰é¡¹
            const voiceSelect = document.getElementById('voiceSelect');
            if (voiceSelect) {
                const defaultOption = voiceSelect.querySelector('option[value="none"]');
                if (defaultOption && defaultOption.hasAttribute('data-i18n')) {
                    defaultOption.textContent = texts['default-voice'];
                }
            }

            // æ›´æ–°æ’­æ”¾æŒ‰é’®æ–‡æœ¬
            const playPauseBtn = document.getElementById('playPauseBtn');
            if (playPauseBtn) {
                const isPlaying = playPauseBtn.textContent.includes('â¸ï¸');
                if (isPlaying) {
                    playPauseBtn.textContent = 'â¸ï¸ ' + texts['pause-btn'];
                } else {
                    playPauseBtn.textContent = 'â–¶ï¸ ' + texts['play-btn'];
                }
            }

            // æ›´æ–°åŠ¨æ€ç”Ÿæˆçš„åˆ é™¤æŒ‰é’®æ–‡æœ¬
            const deleteButtons = document.querySelectorAll('button[data-i18n="delete-btn"]');
            deleteButtons.forEach(button => {
                button.textContent = texts['delete-btn'];
            });
        }

        // ä¿å­˜è¯­è¨€åå¥½
        function saveLanguagePreference() {
            localStorage.setItem('tts-language', currentLanguage);
        }

        // åŠ è½½è¯­è¨€åå¥½
        function loadLanguagePreference() {
            const saved = localStorage.getItem('tts-language');
            if (saved && i18nTexts[saved]) {
                currentLanguage = saved;
                updateLanguage();
            }
        }

        // é¡µé¢åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            // åŠ è½½è¯­è¨€åå¥½
            loadLanguagePreference();
            
            // åˆå§‹åŒ–éŸ³è‰²ä¸Šä¼ åŠŸèƒ½
            setupVoiceUpload();
            
            // åˆå§‹åŒ–éŸ³è‰²é€‰æ‹©ç›‘å¬å™¨
            setupVoiceSelectListener();
            
            // åŠ è½½éŸ³è‰²åˆ—è¡¨
            loadVoiceList();
            
            // åˆå§‹åŒ–æ ‡ç­¾é¡µåˆ‡æ¢
            const tabButtons = document.querySelectorAll('.tab-button');
            tabButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const targetTab = this.getAttribute('data-tab');
                    switchTab(targetTab);
                });
            });
            
            // é«˜çº§é€‰é¡¹ç°åœ¨é»˜è®¤æ˜¾ç¤ºï¼Œæ ¹æ®éŸ³è‰²é€‰æ‹©è‡ªåŠ¨æ§åˆ¶
        });
    </script>
</body>
</html>